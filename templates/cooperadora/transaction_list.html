{% extends 'base.html' %}
{% block title %}Transacciones — Cooperadora{% endblock %}
{% block content %}
<h2>Transacciones</h2>
{% load money_filters %}
<p>
  {% if perms.cooperadora.add_transaction %}
    <a class="btn" href="{% url 'cooperadora:transaction_add' %}">Nueva transacción</a>
  {% endif %}
</p>
<table class="table">
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Tipo</th>
      <th style="text-align:right">Ingresos</th>
      <th style="text-align:right">Egresos</th>
      <th>Descripción</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for r in rows %}
      <tr>
        <td>{{ r.date }}</td>
        <td>{{ r.type }}</td>
  <td style="text-align:right">{% if r.income %}{{ r.income|money }}{% else %}&nbsp;{% endif %}</td>
  <td style="text-align:right">{% if r.expense %}{{ r.expense|money }}{% else %}&nbsp;{% endif %}</td>
        <td>{{ r.description }}</td>
        <td>
          {% if perms.cooperadora.change_transaction %}
            <a href="{% url 'cooperadora:transaction_edit' r.pk %}">Editar</a>
          {% endif %}
          {% if perms.cooperadora.delete_transaction %}
            &nbsp;|&nbsp;<a href="{% url 'cooperadora:transaction_delete' r.pk %}">Eliminar</a>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="6">No hay transacciones.</td></tr>
    {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <td colspan="2" style="text-align:right"><strong>Totales:</strong></td>
  <td style="text-align:right"><strong>{{ total_income|money }}</strong></td>
  <td style="text-align:right"><strong>{{ total_expense|money }}</strong></td>
      <td colspan="2"></td>
    </tr>
    <tr>
      <td colspan="2" style="text-align:right"><strong>Total general:</strong></td>
      <td colspan="4" style="text-align:right">
        {% if total_general < 0 %}
          <strong style="color:red">{{ total_general|money }}</strong>
        {% else %}
          <strong>{{ total_general|money }}</strong>
        {% endif %}
      </td>
    </tr>
  </tfoot>
</table>
{% endblock %}
