{% load static %}
<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Impulsa Gestión{% endblock %}</title>
  <!-- Cache-busting query param to force reload when styles change during development -->
  <link rel="stylesheet" href="{% static 'css/site.css' %}?v=2">
  </head>
  <body>
    <div class="layout">
  <aside class="sidebar" id="site-sidebar" aria-hidden="true">
        <div class="sidebar-brand">
          <a href="/"><img src="{% static 'FullLogo_Transparent.png' %}" alt="Impulsa"/></a>
        </div>
        <nav class="sidebar-nav">
          <a href="/">Inicio</a>
          {% if user.is_authenticated and user.is_superuser or user.is_authenticated and 'students.view_student' in user_perms %}
            <a href="/students/">Alumnos</a>
          {% endif %}
          {% if user.is_authenticated and user.is_superuser or user.is_authenticated and 'courses.view_course' in user_perms %}
            <a href="/courses/">Cursos</a>
          {% endif %}
          {% if user.is_authenticated and user.is_superuser or user.is_authenticated and 'subjects.view_subject' in user_perms %}
            <a href="/subjects/">Asignaturas</a>
          {% endif %}
          {% if user.is_authenticated and user.is_superuser or user.is_authenticated and 'teachers.view_teacher' in user_perms %}
            <a href="/teachers/">Docentes</a>
          {% endif %}
          {% if user.is_authenticated and user.is_superuser or user.is_authenticated and 'projects.view_project' in user_perms %}
            <a href="/projects/">Proyectos</a>
          {% endif %}
          {% if user.is_authenticated and user.is_superuser or user.is_authenticated and 'cooperadora.view_transaction' in user_perms %}
            <a href="/cooperadora/">Cooperadora</a>
          {% endif %}
          {% if user.is_superuser %}
            <a href="/admin/">Admin</a>
          {% endif %}
        </nav>
        <div class="sidebar-roles">
          {% if user.is_authenticated %}
            <strong>Roles:</strong>
            <ul>
              {% for r in user_roles %}<li>{{ r }}</li>{% empty %}<li>--</li>{% endfor %}
            </ul>
          {% endif %}
        </div>
      </aside>

      <div class="main-area">
        <header class="topbar">
          <div class="container topbar-inner">
            <button id="hamburger" class="hamburger" aria-controls="site-sidebar" aria-expanded="false" aria-label="Mostrar navegación">☰</button>
            <div class="search">{% block search %}{% endblock %}</div>
            <div class="top-actions">
              <div class="user-menu">
                  {% if user.is_authenticated %}
                    <div class="user-auth">
                      <img src="{% static 'Acceso_garantizado.png' %}" alt="Acceso garantizado" class="accesso-icon" aria-hidden="true"/>
                      <span class="user-name">{{ user.username }}</span>
                      <a href="{% url 'core:logout' %}" title="Salir" class="logout-link">
                        <img src="{% static 'Salir.png' %}" alt="Salir" class="logout-icon" />
                      </a>
                    </div>
                  {% else %}
                    <a href="{% url 'core:login' %}" title="Ingresar">
                      <img src="{% static 'Accesso.png' %}" alt="Ingresar" class="login-icon" />
                    </a>
                  {% endif %}
                </div>
            </div>
          </div>
        </header>

        <main class="container content-area">
          {% for note in messages %}
            <div class="message {{ note.tags }}">{{ note }}</div>
          {% endfor %}
          {% block content %}{% endblock %}
        </main>
      </div>
    </div>
    <script src="{% static 'js/site.js' %}"></script>

    <footer class="site-footer">
      <div class="container">
        <p>
          Impulsa Gestión — &copy; 2025 — Desarrollado por
          <a href="https://www.bytenco.com.ar" target="_blank" rel="noopener noreferrer" class="bytenco-credit">
            BYTENCO
          </a>
        </p>
      </div>
    </footer>
  </body>
</html>
